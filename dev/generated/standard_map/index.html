<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Standard map · CoherentStructures.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>CoherentStructures.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../rot_double_gyre/">Rotating double gyre</a></li><li class="current"><a class="toctext" href>Standard map</a><ul class="internal"></ul></li><li><a class="toctext" href="../bickley/">Bickley jet</a></li><li><a class="toctext" href="../ocean_flow/">Geostrophic ocean flow</a></li><li><a class="toctext" href="../trajectories/">Working with trajectories</a></li></ul></li><li><a class="toctext" href="../../basics/">Basics</a></li><li><span class="toctext">Methods</span><ul><li><a class="toctext" href="../../fem/">FEM-based methods</a></li><li><a class="toctext" href="../../elliptic/">Geodesic vortices</a></li><li><a class="toctext" href="../../Laplace/">Graph Laplacian-based methods</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Examples</li><li><a href>Standard map</a></li></ul><a class="edit-page" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/master/examples/standard_map.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Standard map</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="The-standard-map-1" href="#The-standard-map-1">The standard map</a></h1><div class="admonition tip"><div class="admonition-title">Tip</div><div class="admonition-text"><p>This example is also available as a Jupyter notebook: <a href="https://nbviewer.jupyter.org/github/CoherentStructures/CoherentStructures.jl/blob/gh-pages/latest/dev/standard_map.ipynb"><code>standard_map.ipynb</code></a>, and as an executable julia file <a href="https://raw.githubusercontent.com/CoherentStructures/CoherentStructures.jl/gh-pages/dev/generated/standard_map.jl"><code>standard_map.jl</code></a>.</p></div></div><p>The standard map</p><div>\[f(x,y) = (x+y+a\sin(x),y+a\sin(x))\]</div><p>is an area-preserving map on the 2-torus <span>$[0,2\pi]^2$</span> resulting from a symplectic time-discretization of the planar pendulum.  For <span>$a = 0.971635$</span>, its phase space shows the characteristic mixture of regular (periodic or quasi-periodic) and chaotic motion.  Here, we repeat the experiment in <a href="https://arxiv.org/abs/1505.05056">Froyland &amp; Junge (2015)</a> and compute coherent structures.</p><p>We first visualize the phase space by plotting 500 iterates of 50 random seed points.</p><pre><code class="language-julia">using Random

a = 0.971635
f(a,x) = (mod2pi(x[1] + x[2] + a*sin(x[1])),
          mod2pi(x[2] + a*sin(x[1])))

X = []
for i in 1:50
    Random.seed!(i)
    x = 2π*rand(2)
    for i in 1:500
        x = f(a,x)
        push!(X,x)
    end
end

using Plots
gr(aspect_ratio=1, legend=:none)
fig = scatter([x[1] for x in X], [x[2] for x in X], markersize=1)</code></pre><p><img src="https://raw.githubusercontent.com/natschil/misc/master/autogen/standard_map_orbits.png" alt/></p><p>Approximating the Dynamic Laplacian by FEM methods is straightforward:</p><pre><code class="language-julia">using Arpack, CoherentStructures, Distances, Tensors

Df(a,x) = Tensor{2,2}((1.0+a*cos(x[1]), a*cos(x[1]), 1.0, 1.0))

n, ll, ur = 100, [0.0, 0.0], [2π, 2π]               # grid size, domain corners
ctx, _ = regularTriangularGrid((n, n), ll, ur)
pred(x,y) = peuclidean(x, y, ur) &lt; 1e-9
bd = boundaryData(ctx, pred)                      # periodic boundary

I = one(Tensor{2,2})                              # identity matrix
Df2(x) = Df(a,f(a,x))⋅Df(a,x)                     # consider 2. iterate
cg(x) = 0.5*(I + dott(inv(Df2(x))))               # avg. inv. Cauchy-Green tensor

K = assembleStiffnessMatrix(ctx, cg, bdata=bd)
M = assembleMassMatrix(ctx, bdata=bd)
λ, v = eigs(K, M, which=:SM)

using Printf
title = [ @sprintf(&quot;\\lambda = %.3f&quot;, λ[i]) for i = 1:4 ]
p = [ plot_u(ctx, v[:,i], bdata=bd, title=title[i],
             clim=(-0.25, 0.25), cb=false) for i in 1:4 ]
fig = plot(p...)</code></pre><p><img src="https://raw.githubusercontent.com/natschil/misc/master/autogen/ standard_map_result.png" alt/></p><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../rot_double_gyre/"><span class="direction">Previous</span><span class="title">Rotating double gyre</span></a><a class="next" href="../bickley/"><span class="direction">Next</span><span class="title">Bickley jet</span></a></footer></article></body></html>
