<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiscale modeling of bone · CoherentStructures.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CoherentStructures.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../rot_double_gyre/">Rotating double gyre</a></li><li><a class="tocitem" href="../standard_map/">Standard map</a></li><li><a class="tocitem" href="../bickley/">Bickley jet</a></li><li><a class="tocitem" href="../ocean_flow/">Geostrophic ocean flow</a></li><li><a class="tocitem" href="../trajectories/">Working with trajectories</a></li></ul></li><li><span class="tocitem">Related publications</span><ul><li><a class="tocitem" href="../../examples_pub_overview/">Overview</a></li><li><a class="tocitem" href="../diffbarriers/">Material diffusion barriers</a></li><li><a class="tocitem" href="../turbulence/">Diffusion barriers in turbulence</a></li><li><a class="tocitem" href="../lifecycle/">Life cycles of Loop Current rings</a></li><li class="is-active"><a class="tocitem" href>Multiscale modeling of bone</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Material-model"><span>Material model</span></a></li><li><a class="tocitem" href="#Usage-of-the-CoherentStructures.jl-package"><span>Usage of the CoherentStructures.jl package</span></a></li><li><a class="tocitem" href="#Code-availability:"><span>Code availability:</span></a></li><li><a class="tocitem" href="#Related-publications:"><span>Related publications:</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../basics/">Basics</a></li><li><span class="tocitem">Methods</span><ul><li><a class="tocitem" href="../../fem/">FEM-based methods</a></li><li><a class="tocitem" href="../../elliptic/">Geodesic vortices</a></li><li><a class="tocitem" href="../../Laplace/">Graph Laplacian-based methods</a></li></ul></li><li><span class="tocitem">Miscellaneous</span><ul><li><a class="tocitem" href="../../videos/">Creating animations</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Related publications</a></li><li class="is-active"><a href>Multiscale modeling of bone</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multiscale modeling of bone</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/master/docs/src/generated/bone_modeling.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Coupled-multiscale-modeling-of-cancellous-bone"><a class="docs-heading-anchor" href="#Coupled-multiscale-modeling-of-cancellous-bone">Coupled multiscale modeling of cancellous bone</a><a id="Coupled-multiscale-modeling-of-cancellous-bone-1"></a><a class="docs-heading-anchor-permalink" href="#Coupled-multiscale-modeling-of-cancellous-bone" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Multiscale modeling of bone has important applications in the early detection, diagnosis and treatment of bone diseases. The most common one is osteoporosis. This bone disease affects especially the elderly population and manifests itself by reducing the volume percentage of cortical bone, one of the two main components of mammal bone besides bone marrow. Simulating the behavior of bone can give important insights into the physical interactions of the system.</p><h2 id="Material-model"><a class="docs-heading-anchor" href="#Material-model">Material model</a><a id="Material-model-1"></a><a class="docs-heading-anchor-permalink" href="#Material-model" title="Permalink"></a></h2><p>The model consists of two scales (macroscopic and microscopic scale) and uses the finite element square method (<span>$\text{FE}^2$</span>) to connect the scales. Starting point for the microscopic scale is the following thermodynamic energy functional, which considers the phases cortical bone (subscript b) and bone marrow (subscript m):</p><p class="math-container">\[\Pi = \int_{\Omega_b} \Psi_{b}(\varepsilon,\textbf{E},\textbf{B}) \text{d}V + \int_{\Omega_m} \Psi_{m}(\varepsilon,\varepsilon^i,\textbf{E},\textbf{B}) + \mathcal{C} \text{d}V + \int_{\Omega_m} \int_{t} \Delta(\dot{\varepsilon}^i,\dot{\textbf{A}}) \text{d}t \text{d}V + \int_{\Omega} \Psi_{g}(\nabla \cdot \textbf{A}) \text{d}V - W_{\text{ext}} \; \text{.}\]</p><p>The functional consists of the energy densities <span>$\Psi_{b}$</span> and <span>$\Psi_{m}$</span> of both phases, a volume constraint <span>$\mathcal{C}$</span>, dissipation and gauge functionals (<span>$\Delta$</span> and <span>$\Psi_{g}$</span>) and the potential of the generalized external forces <span>$W_{\text{ext}}$</span>. The energy densities for both phases are</p><p class="math-container">\[\Psi_b = \frac{1}{2} (\varepsilon \cdot C_b \cdot \varepsilon - \textbf{E} \cdot \xi_b \cdot \textbf{E} + \textbf{B} \cdot \mu_b^{-1} \cdot \textbf{B}) - \textbf{e}_b \cdot \varepsilon \cdot \textbf{E} \quad \text{and}\]</p><p class="math-container">\[\Psi_m = \frac{1}{2} ((\varepsilon-\varepsilon^i) \cdot C_m \cdot (\varepsilon-\varepsilon^i) - \textbf{E} \cdot \xi_m \cdot \textbf{E} + \textbf{B} \cdot \mu_\mathrm{m}^{-1} \cdot \textbf{B}) \; \text{,}\]</p><p>consisting of quadratic energies for mechanical, electric and magnetic effects. A piezoelectric energy term is included in the cortical bone phase. For the bone marrow phase, an inelastic strain <span>$\varepsilon^i$</span> is introduced. Here, <span>$C$</span> is the mechanical stiffness tensor, <span>$\xi$</span> is the permittivity tensor, <span>$\mu^{-1}$</span> is the inverse permeability tensor and <span>$\textbf{e}_b$</span> is the piezoelectric tensor. The resulting strong form of the problem is</p><p class="math-container">\[\nabla \cdot \sigma + \textbf{f} = 0 \quad \text{in} \; \Omega\]</p><p class="math-container">\[ \sigma \cdot \textbf{n} = \textbf{t} \quad \text{on} \; \partial \Omega\]</p><p class="math-container">\[ \nabla \cdot \textbf{D} = q_v \quad \text{in} \; \Omega\]</p><p class="math-container">\[ \textbf{D} \cdot \textbf{n} = -q_s \quad \text{on} \; \partial \Omega\]</p><p class="math-container">\[ \nabla \times \textbf{H} = \dot{\textbf{D}} + \textbf{J} + \gamma \nabla(\nabla \cdot \textbf{A}) + \textbf{j}_v \quad \text{in} \; \Omega\]</p><p class="math-container">\[\textbf{H} \times \textbf{n} = \textbf{j}_s - \gamma (\nabla \cdot \textbf{A}) \textbf{n} \quad \text{on} \; \partial \Omega \; \text{,}\]</p><p>recovering the mechanical equilibrium condition, two Maxwell equations (the other two are implicitly fulfilled due to the choice of potentials) and boundary conditions, including the gauge. By using variational calculus, the problem can be transformed into the weak form and the finite element method can be applied.</p><h2 id="Usage-of-the-CoherentStructures.jl-package"><a class="docs-heading-anchor" href="#Usage-of-the-CoherentStructures.jl-package">Usage of the CoherentStructures.jl package</a><a id="Usage-of-the-CoherentStructures.jl-package-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-of-the-CoherentStructures.jl-package" title="Permalink"></a></h2><p>On the microscopic scale, periodic boundary conditions (PBCs) are desired to obtain good results independent of the relative position of inclusions in the used representative volume element (RVE). The computer program used for the simulations is written in Julia and uses mainly the <a href="generated/ https:/github.com/Ferrite-FEM/Ferrite.jl">Ferrite.jl</a> package. During the development in 2020, the past version of Ferrite.jl (called JuAFEM.jl back then) did not support periodic boundary conditions inherently. The ‘GridContext‘ struct of ‘CoherentStructures.jl‘ expands the ‘Grid‘-type of Ferrite and allows to find nodes on opposite sides (stored via ‘BCTable‘), which is necessary to apply periodic boundary conditions. As the model required seven degrees of freedom (DoFs) in each node, it is necessary to split the resulting solution vector after solving the linear system up into each individual DoF and apply the function ‘undoBCS‘ to receive the complete solution vector. Since 2022, Ferrite directly supports PBCs, also allowing more complicated cases directly in the package. For a detailed explanation, see the following forum post: <a href="https://discourse.julialang.org/t/ferrite-jl-periodic-boundary-conditions/39387">Ferrite-periodic-boundary-conditions</a>.</p><h2 id="Code-availability:"><a class="docs-heading-anchor" href="#Code-availability:">Code availability:</a><a id="Code-availability:-1"></a><a class="docs-heading-anchor-permalink" href="#Code-availability:" title="Permalink"></a></h2><p>The code can be found on <a href="https://github.com/blaszm/bone_fe2_c">Github</a>.</p><h2 id="Related-publications:"><a class="docs-heading-anchor" href="#Related-publications:">Related publications:</a><a id="Related-publications:-1"></a><a class="docs-heading-anchor-permalink" href="#Related-publications:" title="Permalink"></a></h2><p>1.	<a href="https://link.springer.com/article/10.1007/s10237-021-01525-6">Multiscale modeling of cancellous bone</a> 2.	<a href="https://onlinelibrary.wiley.com/doi/full/10.1002/zamm.202100541">Inverse modeling using artificial neural networks</a></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lifecycle/">« Life cycles of Loop Current rings</a><a class="docs-footer-nextpage" href="../../basics/">Basics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 18 March 2023 07:52">Saturday 18 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
