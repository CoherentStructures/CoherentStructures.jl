<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Graph Laplacian-based methods · CoherentStructures.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CoherentStructures.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../generated/rot_double_gyre/">Rotating double gyre</a></li><li><a class="tocitem" href="../generated/standard_map/">Standard map</a></li><li><a class="tocitem" href="../generated/bickley/">Bickley jet</a></li><li><a class="tocitem" href="../generated/ocean_flow/">Geostrophic ocean flow</a></li><li><a class="tocitem" href="../generated/trajectories/">Working with trajectories</a></li></ul></li><li><span class="tocitem">Related publications</span><ul><li><a class="tocitem" href="../examples_pub_overview/">Overview</a></li><li><a class="tocitem" href="../generated/diffbarriers/">Material diffusion barriers</a></li><li><a class="tocitem" href="../generated/turbulence/">Diffusion barriers in turbulence</a></li><li><a class="tocitem" href="../generated/lifecycle/">Life cycles of Loop Current rings</a></li></ul></li><li><a class="tocitem" href="../basics/">Basics</a></li><li><span class="tocitem">Methods</span><ul><li><a class="tocitem" href="../fem/">FEM-based methods</a></li><li><a class="tocitem" href="../elliptic/">Geodesic vortices</a></li><li class="is-active"><a class="tocitem" href>Graph Laplacian-based methods</a><ul class="internal"><li><a class="tocitem" href="#Function-documentation"><span>Function documentation</span></a></li></ul></li></ul></li><li><span class="tocitem">Miscellaneous</span><ul><li><a class="tocitem" href="../videos/">Creating animations</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Methods</a></li><li class="is-active"><a href>Graph Laplacian-based methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Graph Laplacian-based methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/master/docs/src/Laplace.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Graph-Laplacian/diffusion-maps-based-LCS-methods"><a class="docs-heading-anchor" href="#Graph-Laplacian/diffusion-maps-based-LCS-methods">Graph Laplacian/diffusion maps-based LCS methods</a><a id="Graph-Laplacian/diffusion-maps-based-LCS-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Graph-Laplacian/diffusion-maps-based-LCS-methods" title="Permalink"></a></h1><p>The LCS approaches implemented and described in this section are strongly influenced by ideas developed in the spectral clustering/diffusion maps communities. The general references include:</p><ul><li><a href="https://doi.org/10.1109/34.868688">Shi &amp; Malik, Normalized cuts and image segmentation, 2000</a></li><li><a href="https://doi.org/10.1016/j.acha.2006.04.006">Coifman &amp; Lafon, Diffusion maps, 2006</a></li><li><a href="https://doi.org/10.1016/j.acha.2017.11.003">Marshall &amp; Hirn, Time coupled diffusion maps, 2018</a></li></ul><p>In the LCS context, these ideas have been adopted in the following works:</p><ul><li>somewhat related <a href="https://doi.org/10.1063/1.4926372">Froyland &amp; Padberg-Gehle, 2015</a></li><li><a href="https://doi.org/10.1103/PhysRevE.93.063107">Hadjighasem et al., 2016</a></li><li><a href="https://doi.org/10.1063/1.4971788">Banisch &amp; Koltai, 2017</a></li><li><a href="https://doi.org/10.5194/npg-24-189-2017">Rypina et al., 2017</a>/<a href="https://doi.org/10.5194/npg-24-661-2017">Padberg-Gehle &amp; Schneide, 2018</a></li></ul><p>For demonstrations on example cases, please consult the page on <a href="../generated/trajectories/#Working-with-trajectories">Working with trajectories</a>.</p><h2 id="Function-documentation"><a class="docs-heading-anchor" href="#Function-documentation">Function documentation</a><a id="Function-documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Function-documentation" title="Permalink"></a></h2><h3 id="sparsification_methods"><a class="docs-heading-anchor" href="#sparsification_methods">Sparsification methods</a><a id="sparsification_methods-1"></a><a class="docs-heading-anchor-permalink" href="#sparsification_methods" title="Permalink"></a></h3><p>Three commonly used sparsification methods are implemented for use with various graph Laplacian methods.</p><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.KNN" href="#CoherentStructures.KNN"><code>CoherentStructures.KNN</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KNN(k) &lt;: SparsificationMethod</code></pre><p>Defines the KNN (k-nearest neighbors) sparsification method. In this approach, first <code>k</code> nearest neighbors are sought. In the final graph Laplacian, only those particle pairs are included which are contained in some k-Neighborhood.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L35-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.MutualKNN" href="#CoherentStructures.MutualKNN"><code>CoherentStructures.MutualKNN</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MutualKNN(k) &lt;: SparsificationMethod</code></pre><p>Defines the mutual KNN (k-nearest neighbors) sparsification method. In this approach, first <code>k</code> nearest neighbors are sought. In the final graph Laplacian, only those particle pairs are included which are mutually contained in each others k-Neighborhood.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L47-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.Neighborhood" href="#CoherentStructures.Neighborhood"><code>CoherentStructures.Neighborhood</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Neighborhood(ε) &lt;: SparsificationMethod</code></pre><p>Defines the ε-Neighborhood sparsification method. In the final graph Laplacian, only those particle pairs are included which have distance less than <code>ε</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L59-L64">source</a></section></article><p>Other sparsification methods can be implemented by defining a <code>SparsificationMethod</code> type and a corresponding <a href="#CoherentStructures.spdist"><code>spdist</code></a> method.</p><h3 id="Diffusion-maps-type/adjancency-matrix-based-graph-Laplacian-methods"><a class="docs-heading-anchor" href="#Diffusion-maps-type/adjancency-matrix-based-graph-Laplacian-methods">Diffusion-maps-type/adjancency-matrix-based graph Laplacian methods</a><a id="Diffusion-maps-type/adjancency-matrix-based-graph-Laplacian-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Diffusion-maps-type/adjancency-matrix-based-graph-Laplacian-methods" title="Permalink"></a></h3><p>Since the Euclidean heat kernel is ubiquitous in diffusion maps-based computations, we provide it for convenience.</p><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.gaussian" href="#CoherentStructures.gaussian"><code>CoherentStructures.gaussian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">gaussian(σ=1.0)</code></pre><p>Returns the Euclidean heat kernel as a callable function</p><p class="math-container">\[x \mapsto \exp\left(-\frac{x^2}{4\sigma}\right)\]</p><p><strong>Example</strong></p><pre><code class="language-julia-repl">julia&gt; kernel = gaussian(2.0);

julia&gt; kernel(0.)
1.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L3-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.gaussiancutoff" href="#CoherentStructures.gaussiancutoff"><code>CoherentStructures.gaussiancutoff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">gaussiancutoff(σ, θ = eps())</code></pre><p>Computes the positive value at which <a href="#CoherentStructures.gaussian"><code>gaussian(σ)</code></a> equals <code>θ</code>, i.e.,</p><p class="math-container">\[\sqrt{-4\sigma\log(\theta)}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L25-L32">source</a></section></article><p>To compute a sparse distance matrix (or adjacency matrix, depending on the <a href="#sparsification_methods">sparsification method</a>), use <a href="#CoherentStructures.spdist"><code>spdist</code></a>.</p><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.spdist" href="#CoherentStructures.spdist"><code>CoherentStructures.spdist</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">spdist(data, sp_method, metric=Euclidean()) -&gt; SparseMatrixCSC</code></pre><p>Return a sparse distance matrix as determined by the sparsification method <code>sp_method</code> and <code>metric</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/dynamicmetrics.jl#L272-L277">source</a></section></article><p>The main high-level functions for the above-listed methods are the following.</p><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.sparse_diff_op_family" href="#CoherentStructures.sparse_diff_op_family"><code>CoherentStructures.sparse_diff_op_family</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sparse_diff_op_family(data, sp_method, kernel, op_reduce; α, metric, verbose)</code></pre><p>Return a list of sparse diffusion/Markov matrices <code>P</code>.</p><p><strong>Arguments</strong></p><ul><li><code>data</code>: a list of trajectories, each a list of states of type <code>SVector</code>;</li><li><code>sp_method</code>: a sparsification method;</li><li><code>kernel=gaussian()</code>: diffusion kernel, e.g., <a href="#CoherentStructures.gaussian"><code>gaussian</code></a>;</li><li><code>op_reduce=P -&gt; prod(LinearMaps.LinearMap, reverse(P))</code>: time-reduction of diffusion operators, e.g. <code>Statistics.mean</code> (space-time diffusion maps), <code>P -&gt; row_normalize!(min.(sum(P), 1))</code> (network-based coherence) or the default <code>P -&gt; prod(LinearMaps.LinearMap, reverse(P))</code> (time coupled diffusion maps)</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>α=1</code>: exponent in diffusion-map normalization;</li><li><code>metric=Euclidean()</code>: distance function w.r.t. which the kernel is computed, however, only for point pairs where <span>$metric(x_i, x_j)\leq \varepsilon$</span>;</li><li><code>verbose=false</code>: whether to print intermediate progress reports.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L83-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.sparse_diff_op" href="#CoherentStructures.sparse_diff_op"><code>CoherentStructures.sparse_diff_op</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sparse_diff_op(data, sp_method, kernel; α=1, metric=Euclidean()) -&gt; SparseMatrixCSC</code></pre><p>Return a sparse diffusion/Markov matrix <code>P</code>.</p><p><strong>Arguments</strong></p><ul><li><code>data</code>: a list of trajectories, each a list of states of type <code>SVector</code>, or a list of states of type <code>SVector</code>;</li><li><code>sp_method</code>: a sparsification method;</li><li><code>kernel</code>: diffusion kernel, e.g., <a href="#CoherentStructures.gaussian"><code>gaussian</code></a>;</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>α</code>: exponent in diffusion-map normalization;</li><li><code>metric</code>: distance function w.r.t. which the kernel is computed, however, only for point pairs where <span>$metric(x_i, x_j)\leq \varepsilon$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L125-L140">source</a></section></article><h3 id="Normalization-functions"><a class="docs-heading-anchor" href="#Normalization-functions">Normalization functions</a><a id="Normalization-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Normalization-functions" title="Permalink"></a></h3><p>In the diffusion maps framework, there are two commonly used normalization steps:</p><ol><li>kernel-density estimate normalization (<a href="#CoherentStructures.kde_normalize!"><code>kde_normalize!</code></a>), and</li><li>row normalization (<a href="#CoherentStructures.row_normalize!"><code>row_normalize!</code></a>), to obtain a diffusion/Markov operator (w.r.t. right- and left-action, respectively).</li></ol><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.kde_normalize!" href="#CoherentStructures.kde_normalize!"><code>CoherentStructures.kde_normalize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">kde_normalize!(A, α=1)</code></pre><p>Normalize rows and columns of <code>A</code> in-place with the respective row-sum to the α-th power; i.e., return <span>$a_{ij}:=a_{ij}/q_i^{\alpha}/q_j^{\alpha}$</span>, where <span>$q_k = \sum_{\ell} a_{k\ell}$</span>. Default for <code>α</code> is <code>1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L170-L176">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.row_normalize!" href="#CoherentStructures.row_normalize!"><code>CoherentStructures.row_normalize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">row_normalize!(A)</code></pre><p>Normalize rows of <code>A</code> in-place with the respective row-sum; i.e., return <span>$a_{ij}:=a_{ij}/q_i$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L222-L227">source</a></section></article><h3 id="Diffusion-coordinate-like-functions"><a class="docs-heading-anchor" href="#Diffusion-coordinate-like-functions">Diffusion-coordinate-like functions</a><a id="Diffusion-coordinate-like-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Diffusion-coordinate-like-functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.diffusion_coordinates" href="#CoherentStructures.diffusion_coordinates"><code>CoherentStructures.diffusion_coordinates</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">diffusion_coordinates(P, n_coords) -&gt; (Σ, Ψ)</code></pre><p>Compute the (time-coupled) diffusion coordinate matrix <code>Ψ</code> and the coordinate weight vector <code>Σ</code> for a diffusion operator <code>P</code>. The argument <code>n_coords</code> determines the number of diffusion  coordinates to be computed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L291-L297">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CoherentStructures.diffusion_distance" href="#CoherentStructures.diffusion_distance"><code>CoherentStructures.diffusion_distance</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">diffusion_distance(Ψ)</code></pre><p>Returns the symmetric pairwise diffusion distance matrix corresponding to points whose diffusion coordinates are given by <code>Ψ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CoherentStructures/CoherentStructures.jl/blob/12084e7b5e8d35cd6607727800219547578175e2/src/diffusion_operators.jl#L338-L343">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../elliptic/">« Geodesic vortices</a><a class="docs-footer-nextpage" href="../videos/">Creating animations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Monday 12 July 2021 14:18">Monday 12 July 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
